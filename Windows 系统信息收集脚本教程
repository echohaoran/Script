
# 📋 Windows 系统信息收集脚本
一个 PowerShell 脚本，一键生成包含系统、硬件、CPU、磁盘和网络信息的综合报告，并自动保存到桌面。

> **适用对象**：系统管理员、技术支持人员、IT 初学者  
> **运行环境**：Windows 7 及以上（推荐 Windows 10/11 + PowerShell 5.1+）

---

## 🧾 脚本功能

- 自动收集以下信息：
  - 操作系统版本、补丁、启动时间（通过 `systeminfo`）
  - 主板/整机厂商、型号、物理内存（通过 WMI）
  - CPU 型号、核心数、主频
  - 物理硬盘型号、容量、接口类型
  - 网络适配器名称、状态、速率
- 生成带时间戳的文本报告（例如：`SystemReport_20241228_153022.txt`）
- 报告自动保存在当前用户的桌面上

---

## 💻 脚本内容（`export-system-report.ps1`）

```powershell
# 文件名：export-system-report.ps1
# 功能：一键生成 Windows 系统综合报告
# 输出：保存为桌面的文本文件，文件名含时间戳

$ReportPath = "$env:USERPROFILE\Desktop\SystemReport_$(Get-Date -Format 'yyyyMMdd_HHmmss').txt"
$Report = @()

# 系统信息
$Report += "=== 系统信息 ==="
$Report += systeminfo

$Report += ""

# 硬件摘要
$Report += "=== 硬件摘要 ==="
$Report += Get-WmiObject -Class Win32_ComputerSystem | Format-List Manufacturer, Model, TotalPhysicalMemory

$Report += ""

# CPU 信息
$Report += "=== CPU 信息 ==="
$Report += Get-WmiObject -Class Win32_Processor | Format-List Name, NumberOfCores, MaxClockSpeed

$Report += ""

# 磁盘信息
$Report += "=== 磁盘信息 ==="
$Report += Get-WmiObject -Class Win32_DiskDrive | Format-List Model, Size, InterfaceType

$Report += ""

# 网络适配器
$Report += "=== 网络适配器 ==="
$Report += Get-NetAdapter | Format-Table Name, InterfaceDescription, Status, LinkSpeed

# 保存报告
$Report | Out-File -FilePath $ReportPath -Encoding UTF8

Write-Host "报告已保存至: $ReportPath"
```

---

## ▶️ 使用方法

1. **复制脚本**  
   将上述代码保存为 `export-system-report.ps1` 文件（建议使用记事本或 VS Code）。

2. **允许脚本执行（首次运行需设置）**  
   以管理员身份打开 PowerShell，运行：
   ```powershell
   Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
   ```
   > 该命令允许本地脚本运行，不影响系统安全策略。

3. **运行脚本**  
   在 PowerShell 中执行：
   ```powershell
   .\export-system-report.ps1
   ```

4. **查看报告**  
   脚本运行后，桌面会生成类似 `SystemReport_20241228_153022.txt` 的文件，用记事本打开即可。

---

## ⚠️ 注意事项

- **权限问题**：脚本仅读取系统信息，无需管理员权限（但某些企业环境可能限制 WMI 访问）。
- **中文支持**：使用 `-Encoding UTF8` 确保中文字符正确显示。
- **兼容性**：
  - `Get-NetAdapter` 需要 PowerShell 3.0+（Windows 8/Server 2012 及以上默认支持）
  - 若在旧系统（如 Windows 7）运行，可替换为 `Get-WmiObject -Class Win32_NetworkAdapter`，但字段不同

---

## 🛠 扩展建议

- 添加 **显卡信息**：
  ```powershell
  Get-WmiObject -Class Win32_VideoController | Format-List Name, AdapterRAM
  ```
- 导出为 **HTML 或 CSV** 便于分析
- 通过 **邮件自动发送** 报告（结合 `Send-MailMessage`）

---
